/*! grafana - v4.1.2 - 2017-02-13
 * Copyright (c) 2017 Torkel Ã–degaard; Licensed Apache-2.0 */

System.register(["../../core/core_module"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(a,b,c,d){this.$routeParams=a,this.backendSrv=b,this.$scope=c,this.$location=d,this.testSeverity="critical",a.id?this.loadNotification(a.id):this.model={type:"email",settings:{httpMethod:"POST",autoResolve:!0},isDefault:!1}}return a.$inject=["$routeParams","backendSrv","$scope","$location"],a.prototype.loadNotification=function(a){var b=this;this.backendSrv.get("/api/alert-notifications/"+a).then(function(a){b.model=a})},a.prototype.isNew=function(){return void 0===this.model.id},a.prototype.save=function(){var a=this;this.theForm.$valid&&(this.model.id?this.backendSrv.put("/api/alert-notifications/"+this.model.id,this.model).then(function(b){a.model=b,a.$scope.appEvent("alert-success",["Notification updated",""])}):this.backendSrv.post("/api/alert-notifications",this.model).then(function(b){a.$scope.appEvent("alert-success",["Notification created",""]),a.$location.path("alerting/notifications")}))},a.prototype.typeChanged=function(){this.model.settings={}},a.prototype.testNotification=function(){var a=this;if(this.theForm.$valid){var b={name:this.model.name,type:this.model.type,settings:this.model.settings};this.backendSrv.post("/api/alert-notifications/test",b).then(function(b){a.$scope.appEvent("alert-succes",["Test notification sent",""])})}},a}(),a("AlertNotificationEditCtrl",d),c.default.controller("AlertNotificationEditCtrl",d)}}});